/*!
 * @pixi/mixin-cache-as-bitmap - v5.3.8
 * Compiled Sat, 20 Feb 2021 22:28:33 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{};var _pixi_mixin_cache_as_bitmap=function(t,a,e,i,s,r,n){"use strict";var h=new s.Matrix;i.DisplayObject.prototype._cacheAsBitmap=!1,i.DisplayObject.prototype._cacheData=null;var o=function(){return function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}();return Object.defineProperties(i.DisplayObject.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var a;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new o),(a=this._cacheData).originalRender=this.render,a.originalRenderCanvas=this.renderCanvas,a.originalUpdateTransform=this.updateTransform,a.originalCalculateBounds=this.calculateBounds,a.originalGetLocalBounds=this.getLocalBounds,a.originalDestroy=this.destroy,a.originalContainsPoint=this.containsPoint,a.originalMask=this._mask,a.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((a=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=a.originalRender,this.renderCanvas=a.originalRenderCanvas,this.calculateBounds=a.originalCalculateBounds,this.getLocalBounds=a.originalGetLocalBounds,this.destroy=a.originalDestroy,this.updateTransform=a.originalUpdateTransform,this.containsPoint=a.originalContainsPoint,this._mask=a.originalMask,this.filterArea=a.originalFilterArea))}}}),i.DisplayObject.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},i.DisplayObject.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var i=this.alpha;this.alpha=1,t.batch.flush();var s=this.getLocalBounds(null,!0).clone();if(this.filters){var o=this.filters[0].padding;s.pad(o)}s.ceil(n.settings.RESOLUTION);var c=t.renderTexture.current,l=t.renderTexture.sourceFrame.clone(),d=t.projection.transform,u=a.RenderTexture.create({width:s.width,height:s.height}),p="cacheAsBitmap_"+r.uid();this._cacheData.textureCacheId=p,a.BaseTexture.addToCache(u.baseTexture,p),a.Texture.addToCache(u,p);var _=this.transform.localTransform.copyTo(h).invert().translate(-s.x,-s.y);this.render=this._cacheData.originalRender,t.render(this,u,!0,_,!1),t.projection.transform=d,t.renderTexture.bind(c,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var D=new e.Sprite(u);D.transform.worldTransform=this.transform.worldTransform,D.anchor.x=-s.x/s.width,D.anchor.y=-s.y/s.height,D.alpha=i,D._bounds=this._bounds,this._cacheData.sprite=D,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=D.containsPoint.bind(D)}},i.DisplayObject.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},i.DisplayObject.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var i=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;var o=t.context,c=t._projTransform;i.ceil(n.settings.RESOLUTION);var l=a.RenderTexture.create({width:i.width,height:i.height}),d="cacheAsBitmap_"+r.uid();this._cacheData.textureCacheId=d,a.BaseTexture.addToCache(l.baseTexture,d),a.Texture.addToCache(l,d);var u=h;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=i.x,u.ty-=i.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,l,!0,u,!1),t.context=o,t._projTransform=c,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var p=new e.Sprite(l);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-i.x/i.width,p.anchor.y=-i.y/i.height,p.alpha=s,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=p.containsPoint.bind(p)}},i.DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},i.DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},i.DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,a.BaseTexture.removeFromCache(this._cacheData.textureCacheId),a.Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},i.DisplayObject.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},t.CacheData=o,t}({},PIXI,PIXI,PIXI,PIXI,PIXI.utils,PIXI);
//# sourceMappingURL=mixin-cache-as-bitmap.min.js.map
