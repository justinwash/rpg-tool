/*!
 * @pixi/canvas-mesh - v5.3.8
 * Compiled Sat, 20 Feb 2021 22:28:33 UTC
 *
 * @pixi/canvas-mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{};var _pixi_canvas_mesh=function(t,e,a,r,n,i){"use strict";var s=function(){function t(t){this.renderer=t}return t.prototype.render=function(t){var a=this.renderer,r=t.worldTransform;a.context.globalAlpha=t.worldAlpha,a.setBlendMode(t.blendMode),a.setContextTransform(r,t.roundPixels),t.drawMode!==e.DRAW_MODES.TRIANGLES?this._renderTriangleMesh(t):this._renderTriangles(t)},t.prototype._renderTriangleMesh=function(t){for(var e=t.geometry.buffers[0].data.length,a=0;a<e-2;a++){var r=2*a;this._renderDrawTriangle(t,r,r+2,r+4)}},t.prototype._renderTriangles=function(t){for(var e=t.geometry.getIndex().data,a=e.length,r=0;r<a;r+=3){var n=2*e[r],i=2*e[r+1],s=2*e[r+2];this._renderDrawTriangle(t,n,i,s)}},t.prototype._renderDrawTriangle=function(t,e,r,n){var i=this.renderer.context,s=t.geometry.buffers[0].data,h=t.uvs,o=t.texture;if(o.valid){var d=16777215!==t.tint,l=o.baseTexture,v=l.width,c=l.height;d&&t._cachedTint!==t.tint&&(t._cachedTint=t.tint,t._tintedCanvas=a.canvasUtils.getTintedCanvas(t,t.tint));var u=d?t._tintedCanvas:l.getDrawableSource(),p=h[e]*l.width,_=h[r]*l.width,g=h[n]*l.width,f=h[e+1]*l.height,m=h[r+1]*l.height,M=h[n+1]*l.height,T=s[e],y=s[r],P=s[n],x=s[e+1],w=s[r+1],C=s[n+1],I=t.canvasPadding/this.renderer.resolution;if(I>0){var b=I/Math.abs(t.worldTransform.a),S=I/Math.abs(t.worldTransform.d),A=(T+y+P)/3,D=(x+w+C)/3,U=T-A,N=x-D,X=Math.sqrt(U*U+N*N);T=A+U/X*(X+b),x=D+N/X*(X+S),N=w-D,y=A+(U=y-A)/(X=Math.sqrt(U*U+N*N))*(X+b),w=D+N/X*(X+S),N=C-D,P=A+(U=P-A)/(X=Math.sqrt(U*U+N*N))*(X+b),C=D+N/X*(X+S)}i.save(),i.beginPath(),i.moveTo(T,x),i.lineTo(y,w),i.lineTo(P,C),i.closePath(),i.clip();var B=p*m+f*g+_*M-m*g-f*_-p*M,R=T*m+f*P+y*M-m*P-f*y-T*M,E=p*y+T*g+_*P-y*g-T*_-p*P,H=p*m*P+f*y*g+T*_*M-T*m*g-f*_*P-p*y*M,V=x*m+f*C+w*M-m*C-f*w-x*M,q=p*w+x*g+_*C-w*g-x*_-p*C,F=p*m*C+f*w*g+x*_*M-x*m*g-f*_*C-p*w*M;i.transform(R/B,V/B,E/B,q/B,H/B,F/B),i.drawImage(u,0,0,v*l.resolution,c*l.resolution,0,0,v,c),i.restore(),this.renderer.invalidateBlendMode()}},t.prototype.renderMeshFlat=function(t){var e=this.renderer.context,a=t.geometry.getBuffer("aVertexPosition").data,r=a.length/2;e.beginPath();for(var n=1;n<r-2;++n){var i=2*n,s=a[i],h=a[i+1],o=a[i+2],d=a[i+3],l=a[i+4],v=a[i+5];e.moveTo(s,h),e.lineTo(o,d),e.lineTo(l,v)}e.fillStyle="#FF0000",e.fill(),e.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();r.settings.MESH_CANVAS_PADDING=0,n.MeshMaterial.prototype._renderCanvas=function(t,e){t.plugins.mesh.render(e)},i.NineSlicePlane.prototype._cachedTint=16777215,i.NineSlicePlane.prototype._tintedCanvas=null,i.NineSlicePlane.prototype._canvasUvs=null,i.NineSlicePlane.prototype._renderCanvas=function(t){var e=t.context,r=this.worldTransform,n=16777215!==this.tint,i=this.texture;if(i.valid){n&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=a.canvasUtils.getTintedCanvas(this,this.tint));var s=n?this._tintedCanvas:i.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var h=this.vertices,o=this._canvasUvs,d=n?0:i.frame.x,l=n?0:i.frame.y,v=d+i.frame.width,c=l+i.frame.height;o[0]=d,o[1]=d+this._leftWidth,o[2]=v-this._rightWidth,o[3]=v,o[4]=l,o[5]=l+this._topHeight,o[6]=c-this._bottomHeight,o[7]=c;for(var u=0;u<8;u++)o[u]*=i.baseTexture.resolution;e.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode),t.setContextTransform(r,this.roundPixels);for(var p=0;p<3;p++)for(var _=0;_<3;_++){var g=2*_+8*p,f=Math.max(1,o[_+1]-o[_]),m=Math.max(1,o[p+5]-o[p+4]),M=Math.max(1,h[g+10]-h[g]),T=Math.max(1,h[g+11]-h[g+1]);e.drawImage(s,o[_],o[p+4],f,m,h[g],h[g+1],M,T)}}};var h=!1;return n.Mesh.prototype._cachedTint=16777215,n.Mesh.prototype._tintedCanvas=null,n.Mesh.prototype._renderCanvas=function(t){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(t,this):h||(h=!0,window.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},n.Mesh.prototype._canvasPadding=null,Object.defineProperty(n.Mesh.prototype,"canvasPadding",{get:function(){return null!==this._canvasPadding?this._canvasPadding:r.settings.MESH_CANVAS_PADDING},set:function(t){this._canvasPadding=t}}),i.SimpleMesh.prototype._renderCanvas=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)},i.SimpleRope.prototype._renderCanvas=function(t){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)},t.CanvasMeshRenderer=s,t}({},PIXI,PIXI,PIXI,PIXI,PIXI);Object.assign(this.PIXI,_pixi_canvas_mesh);
//# sourceMappingURL=canvas-mesh.min.js.map
